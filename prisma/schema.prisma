generator client {
  provider   = "prisma-client-js"
  engineType = "library"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model reviews {
  id          String    @id @default(uuid()) @db.Uuid
  user_id     String?   @db.Uuid
  target_type String    @db.VarChar(20)
  target_id   String    @db.VarChar(50)
  rating      Int?
  comment     String?
  created_at  DateTime? @default(now()) @db.Timestamp(6)
  updated_at  DateTime? @default(now()) @updatedAt @db.Timestamp(6)
  users       users?    @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([target_type, target_id], map: "idx_reviews_target")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model routes {
  id                String   @id @db.VarChar(50)
  short_name        String?
  long_name         String?
  type              String?  @db.VarChar(10)
  fare              Int?
  forward_direction Boolean?
  trips             trips[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model saved_routes {
  id         String    @id @default(uuid()) @db.Uuid
  user_id    String?   @db.Uuid
  title      String?
  from_stop  String?   @db.VarChar(50)
  to_stop    String?   @db.VarChar(50)
  saved_at   DateTime? @default(now()) @db.Timestamp(6)
  route_id   String?   @db.VarChar(255)
  mode       String?   @db.VarChar(50)
  options    String?
  route_data Json?
  users      users?    @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([user_id, route_id], map: "idx_saved_routes_user_route")
}

model stop_times {
  trip_id        String    @db.VarChar(50)
  stop_id        String?   @db.VarChar(50)
  arrival_time   DateTime? @db.Time(6)
  departure_time DateTime? @db.Time(6)
  stop_sequence  Int
  stops          stops?    @relation(fields: [stop_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  trips          trips     @relation(fields: [trip_id], references: [trip_id], onDelete: Cascade, onUpdate: NoAction)

  @@id([trip_id, stop_sequence])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model stops {
  id         String       @id @db.VarChar(50)
  name       String
  lat        Float
  lng        Float
  type       String?      @db.VarChar(10)
  stop_times stop_times[]
}

model trips {
  trip_id    String       @id @db.VarChar(50)
  route_id   String?      @db.VarChar(50)
  stop_times stop_times[]
  routes     routes?      @relation(fields: [route_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model users {
  id           String         @id @default(uuid()) @db.Uuid
  name         String?
  email        String         @unique
  password     String
  created_at   DateTime?      @default(now()) @db.Timestamp(6)
  path_url     String?
  role         String?        @default("user") @db.VarChar(10)
  reviews      reviews[]
  saved_routes saved_routes[]
}
